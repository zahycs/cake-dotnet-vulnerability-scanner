{
  "swagger": "2.0",
  "info": {
    "title": "OssApi",
    "version": "1-SNAPSHOT"
  },
  "basePath": "/",
  "tags": [
    {
      "name": "Component vulnerability reports"
    },
    {
      "name": "Version"
    }
  ],
  "paths": {
    "/api/v3/component-report": {
      "post": {
        "tags": [
          "Component vulnerability reports"
        ],
        "summary": "Request vulnerability reports for components",
        "description": "",
        "operationId": "post",
        "consumes": [
          "application/vnd.ossindex.component-report-request.v1+json",
          "application/json"
        ],
        "produces": [
          "application/vnd.ossindex.component-report.v1+json",
          "application/json"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "body",
            "required": false,
            "schema": {
              "originalRef": "ComponentReportRequest",
              "$ref": "#/definitions/ComponentReportRequest"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Vulnerability report for components",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/ComponentReport"
              }
            }
          },
          "400": {
            "description": "Missing coordinates version"
          },
          "429": {
            "description": "Too many requests"
          }
        },
        "security": [
          {
            "basicAuth": []
          },
          {
            "apiToken": []
          }
        ]
      }
    },
    "/api/v3/version": {
      "get": {
        "tags": [
          "Version"
        ],
        "summary": "Get service version information",
        "description": "",
        "operationId": "get",
        "produces": [
          "application/vnd.ossindex.version.v1+json",
          "application/json"
        ],
        "parameters": [],
        "responses": {
          "200": {
            "description": "Version information"
          },
          "429": {
            "description": "Too many requests"
          }
        }
      }
    }
  },
  "securityDefinitions": {
    "apiToken": {
      "description": "Use email address for the username and API token for the password.",
      "type": "basic"
    }
  },
  "definitions": {
    "ComponentReport": {
      "type": "object",
      "properties": {
        "coordinates": {
          "type": "string",
          "format": "string",
          "description": "Component coordinates as package-url"
        },
        "description": {
          "type": "string",
          "description": "Component description"
        },
        "reference": {
          "type": "string",
          "format": "string",
          "description": "Component details reference"
        },
        "vulnerabilities": {
          "type": "array",
          "xml": {
            "wrapped": true
          },
          "description": "Vulnerabilities recorded for component",
          "items": {
            "xml": {
              "name": "vulnerability"
            },
            "originalRef": "ComponentReportVulnerability",
            "$ref": "#/definitions/ComponentReportVulnerability"
          }
        }
      },
      "description": "Component vulnerability report"
    },
    "ComponentReportVulnerability": {
      "type": "object",
      "properties": {
        "id": {
          "type": "string",
          "description": "Public identifier"
        },
        "displayName": {
          "type": "string",
          "description": "Display name"
        },
        "title": {
          "type": "string",
          "description": "Vulnerability title"
        },
        "description": {
          "type": "string",
          "description": "Vulnerability description"
        },
        "cvssScore": {
          "type": "number",
          "format": "float",
          "description": "CVSS score"
        },
        "cvssVector": {
          "type": "string",
          "description": "CVSS vector"
        },
        "cwe": {
          "type": "string",
          "description": "CWE"
        },
        "cve": {
          "type": "string",
          "description": "CVE"
        },
        "reference": {
          "type": "string",
          "format": "uri",
          "description": "Vulnerability details reference"
        },
        "versionRanges": {
          "type": "array",
          "description": "Affected version ranges",
          "items": {
            "type": "string"
          }
        }
      },
      "description": "Component vulnerability"
    },
    "ComponentReportRequest": {
      "type": "object",
      "required": [
        "coordinates"
      ],
      "properties": {
        "coordinates": {
          "type": "array",
          "xml": {
            "wrapped": true
          },
          "description": "One or more component coordinates as package-url",
          "items": {
            "type": "string",
            "format": "string",
            "xml": {
              "name": "coordinates"
            }
          }
        }
      },
      "description": "Component vulnerability report request"
    },
    "Version": {
      "type": "object",
      "properties": {
        "version": {
          "type": "string",
          "description": "Version"
        },
        "buildTimestamp": {
          "type": "string",
          "description": "Build timestamp"
        },
        "buildTag": {
          "type": "string",
          "description": "Build tag"
        },
        "buildNotes": {
          "type": "string",
          "description": "Build notes"
        }
      },
      "description": "Version"
    }
  }
}